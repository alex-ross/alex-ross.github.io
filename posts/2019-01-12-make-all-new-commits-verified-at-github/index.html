<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Alexander Ross"/><link rel="canonical" href="https://aross.se/posts/2019-01-12-make-all-new-commits-verified-at-github"/><meta name="twitter:url" content="https://aross.se/posts/2019-01-12-make-all-new-commits-verified-at-github"/><meta name="og:url" content="https://aross.se/posts/2019-01-12-make-all-new-commits-verified-at-github"/><title>Make all new commits verified at GitHub | Alexander Ross</title><meta name="twitter:title" content="Make all new commits verified at GitHub | Alexander Ross"/><meta name="og:title" content="Make all new commits verified at GitHub | Alexander Ross"/><meta name="description" content="A guide to add GPG signatures on all your git commits. Expects that you already have git and HomeBrew installed on your macOS machine."/><meta name="twitter:description" content="A guide to add GPG signatures on all your git commits. Expects that you already have git and HomeBrew installed on your macOS machine."/><meta name="og:description" content="A guide to add GPG signatures on all your git commits. Expects that you already have git and HomeBrew installed on your macOS machine."/><meta name="twitter:card" content="summary"/><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-55009015-1', 'auto');
ga('send', 'pageview');</script><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="/styles.css?v=5" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/ArossWebsite/favicon-96x96.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Alexander Ross"/><meta name="twitter:image" content="https://aross.se/ArossWebsite/logo.png"/><meta name="og:image" content="https://aross.se/ArossWebsite/logo.png"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">Alexander Ross</a></div></header><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4141599655973760" data-ad-slot="7238016739" data-ad-format="auto"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="wrapper"><article><p>⏱ around 4 minutes read time</p><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/git">git</a></li><li><a href="/tags/github">github</a></li></ul><div class="content"><h1>Make all new commits verified at GitHub</h1><p><em>A guide to add GPG signatures on all your git commits. Expects that you already have git and HomeBrew installed on your macOS machine.</em></p><p>When you create a git commit you are free to set any author. For example, let say you would like to create a git commit and make it look like DHH, the creator of <a href="https://rubyonrails.org">Ruby on Rails</a> and founder of <a href="https://basecamp.com">Basecamp</a>, did the commit. The only thing you need to do is to set the author like this.</p><pre data-language="bash"><code>$ git commit --author=<span class="hljs-string">"dhh &lt;david@basecamp.com&gt;"</span>
</code></pre><p>So you can't actually be sure who did commit the code. A solution is to GPG sign the commits to add a verified symbol on GitHub that the commit is authorized by you.</p><p>A signed commit will look like this on GitHub.</p><img src="https://dsc.cloud/aross/Screenshot-2019-01-12-at-15.05.01-ChEdIEJ3F8UXcYZiWs5LTRpKqFGp745VJFtm5fCgFnveSqOEBQusR2LWx6tfG7Z9ZoefoRwbzh3HfXlxYRqVyakEXkwncVHpgyge.png" alt="Image of signed commit from DHH"/><p>An unsigned commit will look like this on GitHub.</p><img src="https://dsc.cloud/aross/Screenshot-2019-01-12-at-15.05.07-lESI8EJ6Eu15AHR3TZk1sYjToFFyEInkUOJGo6UTgfSq5tZ7rD3xAwLzHKCi2pIsqopYBE3Qob8ySfJcLOo0jpY9zpdtaiZE8qJx.png" alt="Image of unsigned commit from DHH"/><h2>Generate GPG key</h2><p>You need GnuPG to get started. Lets install it using HomeBrew.</p><pre data-language="bash"><code>$ brew install gnupg
</code></pre><p>Run the command below and enter your name when asked to. And when asked for your email address, make sure you set the same as the one you use with git.</p><p>Make sure you set a good pass phrase and remember it or store it in a password manager like 1Password and LastPass if you have to write it down anywhere.</p><pre data-language="bash"><code>$ gpg --default-new-key-algo rsa4096 --gen-key
</code></pre><h2>Export public key and add to GitHub</h2><p>First you need to know your key-id. Run the following.</p><pre data-language="bash"><code>$ gpg --list-secret-keys --keyid-format LONG
/Users/foobar/.gnupg/pubring.kbx
------------------------------
sec   rsa4096/3AA5C34371567BD2 2019-01-12 [SC] [expires: 2021-01-11]
      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
uid                 My Name &lt;foobar@example.com&gt;
</code></pre><p>In the example above the key-id is <code>3AA5C34371567BD2</code>. Copy your public key using command below, replace the <code>&lt;key-id&gt;</code> with your key-id.</p><pre data-language="bash"><code>$ gpg --armor --<span class="hljs-built_in">export</span> &lt;key-id&gt; | pbcopy
</code></pre><p>The public key will know be in your clipboard and you can paste it using <code>⌘v</code>. So lets go to your SSH and GPG keys at GitHub.</p><p>Either you click at this link <a href="https://github.com/settings/keys">https://github.com/settings/keys</a> or you navigate to GitHub, click at your profile image at the top right corner, click at settings and then SSH and GPG keys in the left menu.</p><p>Click at "New GPG key". Paste your public key and confirm.</p><h2>Use pinentry-mac to remember pass phrase in macOS Keychain</h2><p>The pass phrase should be secure and hard to guess and it would be great if you don't have to remember it in your head. So let make sure the macOS Keychain will remember it for you.</p><p>Install pinentry-mac.</p><pre data-language="bash"><code>$ brew install pinentry-mac
</code></pre><p>Connect GPG agent to macOS Keychain via pinentry. Storing it in Keychain via pinentry will allow us to setup automatically key signing.</p><pre data-language="bash"><code>$ mkdir -p ~/.gnupg
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"pinentry-program /usr/local/bin/pinentry-mac"</span> &gt; ~/.gnupg/gpg-agent.conf
</code></pre><h2>Configure git to automatically gpgsign your commits</h2><p>Get your key id just as we did at "Export public key and add to GitHub". Then run the following in the terminal. Replace the <code>&lt;key-id&gt;</code> with your key-id.</p><pre data-language="bash"><code>$ git config --global user.signingkey &lt;key-id&gt;
$ git config --global commit.gpgsign <span class="hljs-literal">true</span>
$ git config --global tag.forceSignAnnotated <span class="hljs-literal">true</span>
</code></pre><h2>Try it out</h2><p>If you had GPG agent installed before we recommend that you kill it to make sure it will restart with new settings.</p><pre data-language="bash"><code>$ killall gpg-agent
</code></pre><p>Create a test git directory</p><pre data-language="bash"><code>$ mkdir gittest
$ <span class="hljs-built_in">cd</span> gittest
$ git init
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"test"</span> &gt; test.txt
$ git add test.txt
$ git commit -m <span class="hljs-string">"test"</span>
</code></pre><p>First time you commit a pine entry popup will appear and ask for the pass phrase. Make sure you also save it in Keychain so that you don't need to type in pass phrase every time.</p><img src="https://dsc.cloud/aross/Screenshot-2019-01-12-at-16.10.48-XO9aFzqMZIkLwr5SAeAByzQqSCzFInRQleiACDYv1wI7QGi5AYezLHFuwdhVFnZEUMFEsrX6qvnaIMmYpQUedLzQY23hDqtcE3PU.png" alt="Image of popup window from Pinentry Mac"/><p>If you create and push the repository to GitHub you will now see that it contains a verified commit.</p><img src="https://dsc.cloud/aross/Screenshot-2019-01-12-at-16.19.24-5yjz5AknDg7daHt38lAc83QD7pyPQvI5v5lIJWXsherJS6oT2ugj7DLMq2GKoIjGVkKuPmbV6GexzAX8f4dzezftx1cTY99aEOBo.png" alt="Image of verified test commit"/></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/git">git</a></li><li><a href="/tags/github">github</a></li></ul></article></div><footer><p><a href="https://standout.se">Work with me</a></p><p><a href="/feed.rss">RSS feed</a></p><p><a href="https://github.com/JohnSundell/Publish">This is a static website built with Publish</a></p></footer></body></html>